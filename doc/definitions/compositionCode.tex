\renewcommand{\ttdefault}{pcr}
\begin{lstlisting}[escapeinside={[*}{*]},basicstyle=\scriptsize\ttfamily,columns=flexible,frame=lines,mathescape=true,xleftmargin=3.0ex,keywordstyle=\textbf,morekeywords={if,while,do,else,fork,int,null, algorithm, is, input, output, return},numbers=left,numberstyle=\scriptsize]
algorithm compose_automata is
	input: $A_1 \ldots A_N$  the set of CLTS automata to be composed
	input: $type$ an element of $\{synch,asynch,concurrent\}$ the type of composition to be applied
	output: $A$ the CLTS automaton that results from applying $\parallel_{type}$ to $A$
	$s_0$ = $(s^1_{0},\ldots,s^N_{0})$
	$frontier$ = [$s_0$]
	$A$ = create_automaton($s_0$)
	$visited$ = $[]$
	while(|$frontier$| > 0)
		$\Delta_{union}$ = $\emptyset$
		$\Sigma_{union}$ = $\emptyset$		
		
		$s$ = $frontier$.pop()
		if $s \in visited$
			continue
		$visited$.push($s$)
		for $s_i \in s$ 
			if $\Delta_{union} = \emptyset$
				$\Delta_{union}$ = $\Delta_i(s)$
			else 
				$\Delta'$ = $\emptyset$
				$\Delta''$ = $\emptyset$
				for $d \in \Delta_{union}$
					for $d' \in \Delta_{i}(s)$
						if $\Sigma \cap label(d') = \Sigma_i \cap label(d)$
							$\Delta'$ = $\Delta' \cup$ {($s$,$label(d) \cup label(d')$,$t(d)_1, \ldots, (t(d')_i, \ldots, t(d)_N$))}
						if $\Sigma \cap label(d') = \Sigma_i \cap label(d) = \emptyset$
							$\Delta''$ = $\Delta'' \cup$ {$(s$,$label(d)$,($t(d)_1, \ldots, t(d)_N$))}							
							$\Delta''$ = $\Delta'' \cup$ {$(s$,$label(d')$,($s(d)_1, \ldots, t(d')_i, \ldots, s(d)_N$))}
				if $type = synch$
					$\Delta_{union}$ = $\Delta'$
				if $type = concurrent$
					$\Delta_{union}$ = $\Delta' \cup \Delta''$					
				if $type = asynch$
					$\Delta_{union}$ = $\Delta''$					
		$\Delta$_expand_frontier($frontier$,$\Delta_{union}$, $visited$)				
		add_transitions($A$, $\Delta_{partial}$)
	return $A$

\end{lstlisting}