const N = 3
const K = 1

const Philosophers = N
const Steps = K

range R_Phil = 0..Philosophers-1
range R_Steps = 1..Steps

set Global_Alphabet = {think[r:R_Phil], step[r:R_Phil], take[r:R_Phil][c:R_Phil], release[r:R_Phil][c:R_Phil],eat[r:R_Phil],eat_all}
set Controllable_Alphabet = {take[r:R_Phil][c:R_Phil]}

/*****************************************************************************/

Philosopher[id:R_Phil] = Idle,
  Idle = (think[id] -> Hungry),
  Hungry = (take[id][id] -> Etiquete[Steps]),
  Etiquete[s:R_Steps] = (step[id] -> Etiquete[s-1]),
  Etiquete[0] =  (take[id][(id+1)% Philosophers] -> eat[id] -> release[id][id] -> release[id][(id+1)% Philosophers] -> Idle).

Fork[id:R_Phil] = OnTable,
  OnTable = (take[(id+1)% Philosophers][id]     -> OnHand  |  take[id][id]    -> OnHand  ),
  OnHand  = (release[(id+1)% Philosophers][id]  -> OnTable |  release[id][id] -> OnTable ).

Monitor[id:R_Phil] = (eat[id] -> Done),
  Done = (eat[id] -> Done | eat_all -> Monitor_0).
/*
Monitor_Remove[id:R_Phil] = (eat[id] -> Done),
  Done = (eat[id] -> Done).
*/
//*****************************************************************************

||Plant = (Philosopher[p:R_Phil] || Fork[f:R_Phil] || Monitor[m:R_Phil]).

//*****************************************************************************	

fluent F_Ass = <eat_all, eat[r:R_Phil]> initially 1
fluent F_GOAL = <eat_all, eat[r:R_Phil]>

|F| ENV = (Plant).

|gr1| <{F_Ass}><{F_GOAL}>  STRAT = ENV.

//|gr1| <{}><{F_GOAL}>  NO_STRAT = ENV.
/*
||Plant_remove = (Philosopher[p:R_Phil] || Fork[f:R_Phil] || Monitor_Remove[m:R_Phil]).
|F| REMOVE_ENV = (Plant_remove).

|gr1| <{}><{F_GOAL}>  REMOVE_NO_STRAT = REMOVE_ENV.

Philosopher_0 >> "/tmp/DP_2_2_ph_0.rep".
Fork_0 >> "/tmp/DP_2_2_f_0.rep".
Plant_1 >> "/tmp/DP_2_2_plant_1.rep".
Plant_0 >> "/tmp/DP_2_2_plant_0.rep".
STRAT >>_m "/tmp/DP_2_2_strat.met".
STRAT >> "/tmp/DP_2_2_strat.rep".
NO_STRAT >>_m "/tmp/DP_2_2_diag.met".
NO_STRAT >> "/tmp/DP_2_2_diag.rep".
REMOVE_NO_STRAT >>_m "/tmp/DP_2_2_remove_diag.met".
REMOVE_NO_STRAT >> "/tmp/DP_2_2_remove_diag.rep".
ENV >> "/tmp/DP_2_2_env.rep".
ENV >>_m "/tmp/DP_2_2_env.met".
*/
